/*! d3.chart.multi - v0.11.1
 * https://github.com/CSNW/d3.chart.multi
 * License: MIT
 */

!function(d3,a){function b(a,b){b=b||{};var d=b.prop_key||"__properties",e=function(f){function g(){var d=c(i[a],e.default_value);return utils.isFunction(d)&&"Function"!=b.type&&(d=d.call(this)),utils.isFunction(b.get)?b.get.call(j,d):d}function h(c){if(utils.isFunction(b.validate)&&!b.validate.call(this,c))throw new Error("Invalid value for "+a+": "+JSON.stringify(c));if(e.previous=i[a],i[a]=c,utils.isFunction(b.set)){var d=b.set.call(j,c,e.previous);d&&utils.has(d,"override")&&(i[a]=d.override),d&&utils.isFunction(d.after)&&d.after.call(j,i[a])}return this}var i=this[d]=this[d]||{},j=(i[a],c(e.context,this));return arguments.length?h.call(this,f):g.call(this)};return e.is_property=!0,e.set_from_options=c(b.set_from_options,!0),e.default_value=b.default_value,e.context=b.context,e}function c(a,b){return utils.isUndefined(a)?b:a}function d(a){var b=a&&a.length&&a[0]&&a[0].length&&a[0][0],c=b?"svg"==b.nodeName:!1,d={width:b&&b.clientWidth,height:b&&b.clientHeight};if(c&&(!b.clientWidth||!b.clientHeight)&&"undefined"!=typeof window&&window.getComputedStyle){var e=window.getComputedStyle(b);d.height=parseFloat(e.height)-parseFloat(e.borderTopWidth)-parseFloat(e.borderBottomWidth),d.width=parseFloat(e.width)-parseFloat(e.borderLeftWidth)-parseFloat(e.borderRightWidth)}if(d.width&&d.height)return d;var f={width:a&&a.attr&&parseFloat(a.attr("width")),height:a&&a.attr&&parseFloat(a.attr("height"))};if(c)return{width:null!=d.width?d.width:f.width||0,height:null!=d.height?d.height:f.height||0};var g={width:0,height:0};try{g=b&&"function"==typeof b.getBBox&&b.getBBox()}catch(h){}return{width:utils.max([d.width,f.width||g.width])||0,height:utils.max([d.height,f.height||g.height])||0}}function e(a,b){return utils.isObject(a)&&(b=a.y,a=a.x),"translate("+(a||0)+", "+(b||0)+")"}function f(a,b){var c="rotate("+(a||0);return b&&(c+=" "+(b.x||0)+","+(b.y||0)),c+=")"}function g(a,b){var c=0;try{var d=window.getComputedStyle(a),e=a.getBBox().height,f=-(parseFloat(d["line-height"])-parseFloat(d["font-size"]))/2;b&&b>0&&(f+=(b-e)/2),c=e+f}catch(g){}return c}function h(a){var b=utils.first(a);return b&&utils.isObject(b)&&utils.isArray(b.values)}function i(a,b){var c=function(a){return a&&d3.extent(a,b)[1]};return h(a)?utils.reduce(a,function(a,b){if(b&&utils.isArray(b.values)){var d=c(b.values);return d>a?d:a}return a},-1/0):c(a)}function j(a,b){var c=function(a){return a&&d3.extent(a,b)[0]};return h(a)?utils.reduce(a,function(a,b){if(b&&utils.isArray(b.values)){var d=c(b.values);return a>d?d:a}return a},1/0):c(a)}function k(a){if(a=a||{},utils.isFunction(a))return a;var b;if(b=a.type&&"time"==a.type?d3.time.scale():a.type&&d3.scale[a.type]?d3.scale[a.type]():d3.scale.linear(),utils.each(a,function(a,c){b[c]&&("range"==c||"domain"==c?b[c](a):utils.contains(["type","data","value","key"],c)||b[c].apply(b,a))}),!a.domain&&a.data&&(a.key||a.value)){var c=a.value||function(b){return b[a.key]},d=a.data;h(d)||(d=[{values:d}]);var e;if("ordinal"==a.type)e=utils.chain(d).map(function(a){return a&&a.values?utils.map(a.values,c):void 0}).flatten().uniq().value();else{var f=j(d,c);e=[0>f?f:0,i(d,c)]}b.domain(e)}return b}function l(a){return a?(a=utils.map(a,function(a,b){return b+": "+a}),a=a.join("; "),a?a+";":""):""}function m(a){var b=function(b,c,d){return a.call(this,void 0,b,c,d)};return b._is_di=!0,b.original=a,b}function n(a,b){return function(c,d,e){return(a.original||a).call(this,b,c,d,e)}}function o(a){for(var b in a)a[b]&&a[b]._is_di&&(a[b]=n(a[b],a))}function p(a){if(a._parent_data)return a._parent_data;var b=a&&a.parentNode;if(b){var c=d3.select(b).data();return c&&c[0]}}function q(a){a=utils.isArray(a)?a:utils.toArray(arguments);var b=utils.extend.apply(null,[{}].concat(a));return delete b.constructor,b.initialize&&(b.initialize=function(){var b=utils.toArray(arguments);utils.each(a,function(a){a.initialize&&a.initialize.apply(this,b)},this)}),b.transform&&(b.transform=function(b){return utils.reduceRight(a,function(a,b){return b&&b.transform?b.transform.call(this,a):a},b,this)}),b}utils={chain:a.chain,clone:a.clone,contains:a.contains,compact:a.compact,difference:a.difference,defaults:a.defaults,each:a.each,extend:a.extend,flatten:a.flatten,first:a.first,has:a.has,isArray:a.isArray,isBoolean:a.isBoolean,isFunction:a.isFunction,isObject:a.isObject,isNumber:a.isNumber,isString:a.isString,isUndefined:a.isUndefined,keys:a.keys,map:a.map,min:a.min,max:a.max,reduce:a.reduce,reduceRight:a.reduceRight,reverse:a.reverse,sortBy:a.sortBy,throttle:a.throttle,toArray:a.toArray,uniq:a.uniq,value:a.value},d3.chart.helpers=utils.extend({},d3.chart.helpers,{utils:utils,property:b,valueOrDefault:c,dimensions:d,translate:e,rotate:f,alignText:g,isSeriesData:h,max:i,min:j,createScale:k,style:l,di:m,bindDi:n,bindAllDi:o,getParentData:p,mixin:q})}(d3,_),function(d3,a){var b=a.utils.each,c=a.property;d3.chart("Base",{initialize:function(){a.bindAllDi(this)},data:c("data"),options:c("options",{default_value:{},set:function(a){b(a,function(a,b){this[b]&&this[b].is_property&&this[b].set_from_options&&this[b](a)},this)}}),width:function(){return a.dimensions(this.base).width},height:function(){return a.dimensions(this.base).height},transform:function(a){return a=a||[],this.data(a),a},draw:function(a){this.trigger("before:draw",a),d3.chart().prototype.draw.apply(this,arguments),this.trigger("draw",a)}})}(d3,d3.chart.helpers),function(d3){d3.chart("Base").extend("Chart",{initialize:function(a){this.options(a||{})}},{z_index:100})}(d3,d3.chart.helpers),function(d3,a){var b=a.utils,c=a.property;d3.chart("Base").extend("Component",{initialize:function(a){this.options(a||{})},position:c("position",{default_value:"top",validate:function(a){return b.contains(["top","right","bottom","left"],a)}}),width:c("width",{default_value:function(){return a.dimensions(this.base).width}}),height:c("height",{default_value:function(){return a.dimensions(this.base).height}}),margins:c("margins",{set:function(a){return{override:b.defaults(a,{top:0,right:0,bottom:0,left:0})}},default_value:{top:0,right:0,bottom:0,left:0}}),skip_layout:!1,prepareLayout:function(a){this.draw(a)},getLayout:function(a){this.prepareLayout(a);var b=this.margins();return{position:this.position(),width:this.width()+b.left+b.right,height:this.height()+b.top+b.bottom}},setLayout:function(b,c,d){var e=this.margins();this.base.attr("transform",a.translate(b+e.left,c+e.top)),this.height(d&&d.height),this.width(d&&d.width)}},{z_index:50})}(d3,d3.chart.helpers),function(d3,a){var b=a.utils,c=a.property;d3.chart("Base").extend("Multi",{initialize:function(a){this.transform=function(a){return this.rawData(a),a},a&&this.options(a),this.base.classed("chart-multi",!0),this.attachHoverListeners()},options:c("options",{default_value:function(){return{}},type:"Function",set:function(a){return this._config=null,b.isFunction(a)?void 0:{override:function(){return a}}}}),rawData:c("rawData"),margins:c("margins",{default_value:{top:10,right:10,bottom:10,left:10},set:function(a){return{override:b.defaults({},a,{top:0,right:0,bottom:0,left:0})}}}),chartPosition:c("chartPosition",{default_value:{top:0,right:0,bottom:0,left:0},set:function(a){return{override:b.defaults({},a,{top:0,right:0,bottom:0,left:0})}},get:function(a){return a.width=this._width()-a.right-a.left,a.height=this._height()-a.bottom-a.top,a}}),width:c("width"),height:c("height"),_width:function(){var a=this.width();return null!=a?a:d3.chart("Base").prototype.width.call(this)},_height:function(){var a=this.height();return null!=a?a:d3.chart("Base").prototype.height.call(this)},charts:c("charts",{set:function(a,c){a=a||{},c=c||{};var d=b.difference(b.keys(c),b.keys(a));return b.each(d,function(a){this.detach(a,c[a]),delete c[a]},this),b.each(a,function(a,b){var d=c[b];if(a instanceof d3.chart())d&&this.detach(b,d),this.attach(b,a),c[b]=a;else if(d&&d.type!=a.type&&(this.detach(b,d),d=void 0),d)d.options(a);else{var e=d3.chart(a.type);if(!e)throw new Error("No registered d3.chart found for "+a.type);var f=this.createChartLayer();d=new e(f,a),d.type=a.type,this.attach(b,d),c[b]=d}},this),{override:c}},default_value:{}}),components:c("components",{set:function(a,c){a=a||{},c=c||{};var d=b.difference(b.keys(c),b.keys(a));return b.each(d,function(a){this.detach(a,c[a]),delete c[a]},this),b.each(a,function(a,b){var d=c[b];if(a instanceof d3.chart())d&&this.detach(b,d),this.attach(b,a),c[b]=a;else if(d&&d.type!=a.type&&(this.detach(b,d),d=void 0),d)d.options(a);else{var e=d3.chart(a.type);if(!e)throw new Error("No registered d3.chart found for "+a.type);var f={z_index:e.z_index},g="chart"==e.layer_type?this.createChartLayer(f):this.createComponentLayer(f);d=new e(g,a),d.type=a.type,this.attach(b,d),c[b]=d}},this),{override:c}},default_value:{}}),draw:function(a){this._config||(a=a.original||a,this._config=this._prepareConfig(a),b.each(this._config,function(a,b){this[b]&&this[b].is_property&&this[b].set_from_options&&this[b](a)},this)),a={original:a,config:this._config.data},this.data(a),this.base.attr("width",this.width()||null).attr("height",this.height()||null),this.layout(a),d3.chart().prototype.draw.call(this,a)},redraw:function(){this.rawData()&&this.draw(this.rawData().original)},demux:function(a,b){return b&&b.config&&b.original?this.charts()[a]&&b.config.charts[a]?b.config.charts[a]:this.components()[a]&&b.config.components[a]?b.config.components[a]:b.original:b},createChartLayer:function(a){return a=b.defaults({},a,{z_index:d3.chart("Chart").z_index}),this.base.append("g").attr("class","chart-layer").attr("data-zIndex",a.z_index)},createComponentLayer:function(a){return a=b.defaults({},a,{z_index:d3.chart("Component").z_index}),this.base.append("g").attr("class","chart-component-layer").attr("data-zIndex",a.z_index)},layout:function(a){this._positionChartLayers();var c=this._extractLayout(a),d=b.extend({},this.margins());b.each(c,function(a,c){b.each(a,function(a){d[c]+=a.offset||0})}),this.chartPosition(d),this._positionLayers(c)},attachHoverListeners:function(){function a(a,b){var c=a[0],d=a[1],e=c-b.left,f=d-b.top;return c>b.left+b.width?e=b.left+b.width:c<b.left&&(e=0),d>b.top+b.height?f=b.top+b.height:d<b.top&&(f=0),{container:{x:c,y:d},chart:{x:e,y:f}}}var c,d,e=this.trigger.bind(this),f=this.chartPosition.bind(this),g=b.throttle(function(a){c&&e("move:mouse",a)},50);this.base.on("mouseenter",function(){c=!0,d=f(),e("enter:mouse",a(d3.mouse(this),d))}),this.base.on("mousemove",function(){g(a(d3.mouse(this),d))}),this.base.on("mouseleave",function(){c=!1,e("leave:mouse")})},_prepareConfig:function(a){var c=this.options()(a);return c=b.defaults({},c,{charts:{},components:{}}),c.data={charts:{},components:{}},b.each(c.charts,function(a,d){a.data&&(c.data.charts[d]=a.data,a=b.clone(a),delete a.data,c.charts[d]=a)}),b.each(c.components,function(a,d){a.data&&(c.data.components[d]=a.data,a=b.clone(a),delete a.data,c.components[d]=a)}),c},attach:function(a,c){c.id=a,c.base.attr("data-id",a),c.container=this,d3.chart("Base").prototype.attach.call(this,a,c),c&&b.isFunction(c.trigger)&&c.trigger("attach")},detach:function(a,c){c.base.remove(),delete this._attached[a],c&&b.isFunction(c.trigger)&&c.trigger("detach")},_positionLayers:function(a){this._positionChartLayers(),this._positionComponents(a),this._positionByZIndex()},_positionChartLayers:function(){var b=this.chartPosition();this.base.selectAll(".chart-layer").attr("transform",a.translate(b.left,b.top)).attr("width",b.width).attr("height",b.height)},_positionComponents:function(a){function c(a,c,d,e){a&&b.isFunction(a.setLayout)&&a.setLayout(c,d,e)}var d=this.chartPosition(),e=this._width(),f=this._height();b.reduce(a.top,function(a,b){var e=a-b.offset;return c(b.component,d.left,e,{width:d.width}),e},d.top),b.reduce(a.right,function(a,b,e,f){var g=f[e-1]||{offset:0},h=a+g.offset;return c(b.component,h,d.top,{height:d.height}),h},e-d.right),b.reduce(a.bottom,function(a,b,e,f){var g=f[e-1]||{offset:0},h=a+g.offset;return c(b.component,d.left,h,{width:d.width}),h},f-d.bottom),b.reduce(a.left,function(a,b){var e=a-b.offset;return c(b.component,e,d.top,{height:d.height}),e},d.left)},_positionByZIndex:function(){var a=this.base.selectAll(".chart-layer, .chart-component-layer")[0];a=b.sortBy(a,function(a){return parseInt(d3.select(a).attr("data-zIndex"))||0}),b.each(a,function(a){a.parentNode.appendChild(a)},this)},_extractLayout:function(a){var c={top:[],right:[],bottom:[],left:[]};return b.each(this.components(),function(d,e){if(!d.skip_layout){var f=d.getLayout(this.demux(e,a)),g=f&&f.position;b.contains(["top","right","bottom","left"],g)&&c[g].push({offset:"top"==g||"bottom"==g?f.height:f.width,component:d})}},this),c}})}(d3,d3.chart.helpers),function(d3,a){var b=a.property,c=a.valueOrDefault,d=a.di,e={seriesKey:d(function(a,b){return b.key}),seriesValues:d(function(a,b,c){return b.seriesIndex=c,b.values}),seriesClass:d(function(a,b,c){return"chart-series chart-index-"+c+(b["class"]?" "+b["class"]:"")}),seriesIndex:d(function(a,b,c){var d=a.seriesData.call(this,b,c);return d&&d.seriesIndex||0}),seriesData:d(function(){return a.getParentData(this)}),itemStyle:d(function(b,c){return a.style(c.style)||null}),seriesLayer:function(a,b,c){if(c&&c.dataBind){var d=c.dataBind;c.dataBind=function(a){var b=this.chart(),c=this.selectAll("g").data(a,b.seriesKey);return c.enter().append("g").attr("class",b.seriesClass).attr("style",b.itemStyle),c.exit().remove(),c.chart=function(){return b},d.call(c,b.seriesValues)}}return d3.chart().prototype.layer.call(this,a,b,c)},seriesCount:function(){var b=this.data();return b&&a.isSeriesData(b)?b.length:1},transform:function(b){return a.isSeriesData(b)?b:[{values:b}]}},f={initialize:function(){this.on("before:draw",this.setScales.bind(this))},xScale:b("xScale",{type:"Function",set:function(b){var c=a.createScale(b);return this.setXScaleRange(c),{override:c}},get:function(a){return a||(a=this.getDefaultXScale(),this.setXScaleRange(a)),a}}),yScale:b("yScale",{type:"Function",set:function(b){var c=a.createScale(b);return this.setYScaleRange(c),{override:c}},get:function(a){return a||(a=this.getDefaultYScale(),this.setYScaleRange(a)),a}}),x:d(function(a,b,c){return parseFloat(a.xScale()(a.xValue.call(this,b,c)))}),y:d(function(a,b,c){return parseFloat(a.yScale()(a.yValue.call(this,b,c)))}),key:d(function(a,b,d){return c(b.key,a.xValue.call(this,b,d))}),x0:function(){return parseFloat(this.xScale()(0))},y0:function(){return parseFloat(this.yScale()(0))},xValue:d(function(a,b){return b?"x"in b?b.x:b[0]:void 0}),yValue:d(function(a,b){return b?"y"in b?b.y:b[1]:void 0}),setScales:function(){this.setXScaleRange(this.xScale()),this.setYScaleRange(this.yScale())},setXScaleRange:function(a){a.range([0,this.width()])},setYScaleRange:function(a){a.range([this.height(),0])},getDefaultXScale:function(){return a.createScale({data:this.data(),key:"x"})},getDefaultYScale:function(){return a.createScale({data:this.data(),key:"y"})}},g=utils.extend({},f,{transform:function(b){function d(a,b){return utils.isObject(a)?!utils.isArray(a)&&utils.isUndefined(a.x)&&(a.x=c(a.key,b)):a={x:b,y:a},a}return a.isSeriesData(b)?utils.each(b,function(a){a.values=utils.map(a.values,d)},this):b=utils.map(b,d),b},itemPadding:b("itemPadding",{default_value:.1}),displayAdjacent:b("displayAdjacent",{default_value:!1}),x:d(function(a,b,c){return a.displayAdjacent()?a.adjacentX.call(this,b,c):a.layeredX.call(this,b,c)}),adjacentX:d(function(a,b,c){var d=a.adjacentWidth.call(this,b,c),e=a.layeredX.call(this,b,c)-a.layeredWidth.call(this,b,c)/2+d/2,f=a.seriesIndex?a.seriesIndex.call(this,b,c):1;return e+d*f}),adjacentWidth:d(function(a,b,c){var d=a.seriesCount?a.seriesCount():1;return d>0?a.layeredWidth.call(this,b,c)/d:0}),layeredX:d(function(a,b,c){return a.xScale()(a.xValue.call(this,b,c))+.5*a.layeredWidth.call(this)||0}),layeredWidth:d(function(a){var b=a.xScale().rangeBand();return isFinite(b)?b:0}),itemWidth:d(function(a,b,c){return a.displayAdjacent()?a.adjacentWidth.call(this,b,c):a.layeredWidth.call(this,b,c)}),setXScaleRange:function(a){utils.isFunction(a.rangeBands)?a.rangeBands([0,this.width()],this.itemPadding(),this.itemPadding()/2):f.setXScaleRange.call(this,a)},getDefaultXScale:function(){return a.createScale({type:"ordinal",data:this.data(),key:"x"})}}),h={attachLabels:function(){var a=this.labels();a.parent=this;var b=d3.chart(a.type),c=this.base.append("g").attr("class","chart-labels"),d=this._labels=new b(c,a);utils.each(this.proxyLabelMethods,function(a){d[a]=this[a]},this),this.on("draw",function(b){a=this.labels(),a.parent=this,d.options(a),d.draw(a.display!==!1?a.data||b:[])}.bind(this))},labels:b("labels",{get:function(a){return utils.isBoolean(a)?a={display:a}:a||(a={display:!1}),utils.defaults({},a,{type:"Labels"})}}),proxyLabelMethods:[]},i=utils.extend({},h,{proxyLabelMethods:["x","y"]}),j={initialize:function(){this.on("attach",function(){this.container&&(this.container.on("enter:mouse",this.onMouseEnter.bind(this)),this.container.on("move:mouse",this.onMouseMove.bind(this)),this.container.on("leave:mouse",this.onMouseLeave.bind(this)))}.bind(this))},onMouseEnter:function(){},onMouseMove:function(){},onMouseLeave:function(){}},k=utils.extend({},j,{initialize:function(){j.initialize.apply(this,arguments),this.on("before:draw",function(){this._points=void 0})},getPoint:d(function(a,b,c,d){return{x:a.x.call(this,b,c,d),y:a.y.call(this,b,c,d),d:b,i:c,j:d}}),getPoints:function(){function b(a,b,c){var d=utils.map(a,function(a,d){return this.getPoint.call(c,a,d,b)},this);return d.sort(function(a,b){return a.x-b.x}),d}var c=this.data();return!this._points&&c&&(this._points=a.isSeriesData(c)?utils.map(c,function(a,c){return b.call(this,a.values,c,{_parent_data:a})},this):b.call(this,c,0)),this._points},getClosestPoints:function(a){function b(a,b){var d=utils.map(a,function(a){return a.distance=c(a,b),a});return utils.sortBy(d,"distance")}function c(a,b){return Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2))}var d=this.getPoints(),e=[];return d?(d.length&&utils.isArray(d[0])?utils.each(d,function(c){e.push(b(c,a))}):e.push(b(d,a)),e):[]}});d3.chart.mixins=utils.extend(d3.chart.mixins||{},{Series:e,XY:f,XYValues:g,Labels:h,XYLabels:i,Hover:j,XYHover:k})}(d3,d3.chart.helpers),function(d3,a,b){function c(a,b,c,d){var e=d3.select(b),f=e.select("text"),g=e.select("rect");return{x:a.x.call(b,c,d),y:a.y.call(b,c,d),element:b,selection:e,text:{element:f.node(),selection:f},bg:{element:g.node(),selection:g}}}function d(b,c,d){var e=d.text.element.getBBox(),f=a.alignText(d.text.element),g=d.bg.layout={x:c.offset.x,y:c.offset.y,width:e.width+2*c.padding,height:e.height+2*c.padding};d.width=g.width,d.height=g.height,"end"==c.anchor?g.x-=g.width:"middle"==c.anchor&&(g.x-=g.width/2),"bottom"==c.alignment?g.y-=g.height:"middle"==c.alignment&&(g.y-=g.height/2),d.text.layout={x:g.x+g.width/2-e.width/2,y:g.y+g.height/2-e.height/2+f}}function e(a,b){function c(a,b){function c(a){return{left:a.x,right:a.x+a.width,top:a.y,bottom:a.y+a.height}}var d=c(a),e=c(b),f=e.left<d.left&&e.right>d.right,g=e.bottom<d.bottom&&e.top>d.top,h=e.left>=d.left&&e.left<d.right||e.right>d.left&&e.right<=d.right||f,i=e.top>=d.top&&e.top<d.bottom||e.bottom>d.top&&e.bottom<=d.bottom||g;return h&&i}function d(a,b){if(a.group&&b.group)g.each(b.group.labels,function(b){a.group.labels.push(b),b.group=a.group}),f(a.group);else if(a.group)e(b,a.group);else if(b.group)e(a,b.group);else{var c={labels:[]};e(a,c),e(b,c)}}function e(a,b){b.labels.push(a),a.group=b,a.originalY=a.y,f(b)}function f(a){var b=g.chain(a.labels).each(function(a){a.y=a.originalY}).sortBy(function(a){return a.y}).reverse().value();g.each(b,function(a,d){for(var e,f=g.first(b,d),h=f.length-1;h>=0;h--)if(c(a,f[h])){e=f[h];break}e&&(a.y=e.y-a.height)})}g.each(b,function(a,e){g.each(b.slice(e+1),function(b){g.each(b,function(b){g.each(a,function(a){c(a,b)&&d(a,b)})})})})}function f(b,c){c.bg.selection.attr("transform",a.translate(c.bg.layout.x,c.bg.layout.y)).attr("width",c.bg.layout.width).attr("height",c.bg.layout.height),c.text.selection.attr("transform",a.translate(c.text.layout.x,c.text.layout.y)),c.selection.attr("transform",a.translate(c.x,c.y)).attr("opacity",0)}var g=a.utils,h=a.mixin,i=a.property,j=a.di;d3.chart("Chart").extend("Labels",h(b.Series,b.XY,b.XYHover,{initialize:function(){var a=this.options().parent;a&&a.on("attach",function(){this.container=a.container,this.trigger("attach")}.bind(this)),this.seriesLayer("Labels",this.base,{dataBind:function(a){return this.selectAll("g").data(a,this.chart().key)},insert:function(){var a=this.chart(),b=this.append("g").attr("class",a.labelClass).call(a.insertLabels);return b},events:{merge:function(){this.chart().mergeLabels(this)},"merge:transition":function(){var a=this.chart();a.delay&&a.delay()&&this.delay(a.delay()),a.duration&&a.duration()&&this.duration(a.duration()),a.ease&&a.ease()&&this.ease(a.ease()),a.transitionLabels(this)}}})},transform:function(b){return a.isSeriesData(b)||(b=[{key:"labels",name:"Labels",values:b}]),b},format:i("format",{type:"Function",set:function(a){return g.isString(a)?{override:d3.format(a)}:void 0}}),position:i("position",{default_value:"top",validate:function(a){return g.contains(["top","right","bottom","left"],a)}}),offset:i("offset",{default_value:{x:0,y:0},set:function(a){return g.isNumber(a)?(a={top:{x:0,y:-a},right:{x:a,y:0},bottom:{x:0,y:a},left:{x:-a,y:0}}[this.position()],a||(a={x:0,y:0}),{override:a}):void 0}}),padding:i("padding",{default_value:0}),anchor:i("anchor",{default_value:function(){return{top:"middle",right:"start",bottom:"middle",left:"end"}[this.position()]},validate:function(a){return g.contains(["start","middle","end"],a)}}),alignment:i("alignment",{default_value:function(){return{top:"bottom",right:"middle",bottom:"top",left:"middle"}[this.position()]},validate:function(a){return g.contains(["top","middle","bottom"],a)}}),delay:i("delay",{type:"Function"}),duration:i("duration",{type:"Function"}),ease:i("ease",{type:"Function"}),labelText:j(function(b,c,d){var e=a.valueOrDefault(c.label,b.yValue.call(this,c,d)),f=b.format();return f?f(e):e}),labelClass:j(function(a,b){return"chart-label"+(b["class"]?" "+b["class"]:"")}),insertLabels:function(a){a.append("rect").attr("class","chart-label-bg"),a.append("text").attr("class","chart-label-text")},mergeLabels:function(a){var b=this;a.selectAll("text").text(this.labelText);var h=[],i={offset:b.offset(),padding:b.padding(),anchor:b.anchor(),alignment:b.alignment()};a.each(function(a,e,f){h[f]||(h[f]=[]);var g=c(b,this,a,e,f);h[f].push(g),d(b,i,g)}),e(b,h),g.each(h,function(a){g.each(a,function(a){f(b,a)})})},transitionLabels:function(a){a.attr("opacity",1)},onMouseEnter:function(a){var b=this.getClosestPoints(a.chart);this.removeHighlight(),g.each(b,function(a){if(a&&a.length){var b=a[0];b.distance<50&&this.highlightLabel(b)}},this)},onMouseMove:function(a){var b=this.getClosestPoints(a.chart);this.removeHighlight(),g.each(b,function(a){if(a&&a.length){var b=a[0];b.distance<50&&this.highlightLabel(b)}},this)},onMouseLeave:function(){this.removeHighlight()},highlightLabel:function(a){var b=this.base.selectAll("g.chart-series").selectAll("g")[a.j][a.i];b&&d3.select(b).classed("highlight",!0)},removeHighlight:function(){this.base.selectAll("g").selectAll("g").classed("highlight",!1)}}),{z_index:150})}(d3,d3.chart.helpers,d3.chart.mixins),function(d3,a,b){var c=a.mixin,d=a.property,e=a.di;d3.chart("Chart").extend("Bars",c(b.Series,b.XYValues,b.XYLabels,{initialize:function(){this.seriesLayer("Bars",this.base.append("g").classed("chart-bars",!0),{dataBind:function(a){var b=this.chart();return this.selectAll("rect").data(a,b.key)},insert:function(){var a=this.chart();return this.append("rect").attr("class",a.barClass).attr("style",a.itemStyle)},events:{enter:function(){var a=this.chart();this.attr("y",a.y0()).attr("height",0)},merge:function(){var a=this.chart();this.attr("x",a.barX).attr("width",a.itemWidth)},"merge:transition":function(){var a=this.chart();a.delay()&&this.delay(a.delay()),a.duration()&&this.duration(a.duration()),a.ease()&&this.ease(a.ease()),this.attr("y",a.barY).attr("height",a.barHeight)},exit:function(){this.remove()}}}),this.attachLabels()},delay:d("delay",{type:"Function"}),duration:d("duration",{type:"Function"}),ease:d("ease",{type:"Function"}),displayAdjacent:d("displayAdjacent",{default_value:!0}),barHeight:e(function(a,b,c){var d=Math.abs(a.y0()-a.y.call(this,b,c))-a.barOffset();return d>0?d:0}),barX:e(function(a,b,c){return a.x.call(this,b,c)-a.itemWidth.call(this,b,c)/2}),barY:e(function(a,b,c){var d=a.y.call(this,b,c),e=a.y0();return e>d?d:e+a.barOffset()}),barClass:e(function(a,b){return"chart-bar"+(b["class"]?" "+b["class"]:"")}),barOffset:function(){var a=this.container&&this.container.components()["axis.x"];if(a){var b=parseInt(a.base.select(".domain").style("stroke-width"))||0;return b/2}return 0}})),d3.chart("Bars").extend("StackedBars",{transform:function(a){return this.bar_positions=[],a},displayAdjacent:d("displayAdjacent",{default_value:!1}),barHeight:e(function(a,b,c){var d=Math.abs(a.y0()-a.y.call(this,b,c)),e=0===a.seriesIndex.call(this,b,c)?a.barOffset():0;return d>0?d-e:0}),barX:e(function(a,b,c){return a.x.call(this,b,c)-a.itemWidth.call(this,b,c)/2}),barY:e(function(a,b,c){var d=a.y.call(this,b,c),e=a.y0();if(!(d>e)){a.bar_positions.length<=c&&a.bar_positions.push(0);var f=a.bar_positions[c]||e,g=f-(e-d);return a.bar_positions[c]=g,g}})})}(d3,d3.chart.helpers,d3.chart.mixins),function(d3,a,b){{var c=a.mixin,d=a.property;a.di}d3.chart("Chart").extend("Line",c(b.Series,b.XY,b.XYLabels,{initialize:function(){this.seriesLayer("Lines",this.base.append("g").classed("chart-lines",!0),{dataBind:function(){var a=this.chart(),b=a.lines=[];return _.each(a.data(),function(c,d){b[d]=a.createLine(c)}),this.selectAll("path").data(function(b,c){return[a.data()[c]]},a.seriesKey)},insert:function(){var a=this.chart();return this.append("path").classed("chart-line",!0).attr("style",a.itemStyle)},events:{"merge:transition":function(){var a=this.chart(),b=a.lines;a.delay()&&this.delay(a.delay()),a.duration()&&this.duration(a.duration()),a.ease()&&this.ease(a.ease()),this.attr("d",function(c,d){return b[a.seriesIndex.call(this,c,d)](a.seriesValues.call(this,c,d))}).attr("style",a.itemStyle)}}}),this.attachLabels()},interpolate:d("interpolate",{default_value:"monotone"}),delay:d("delay",{type:"Function"}),duration:d("duration",{type:"Function"}),ease:d("ease",{type:"Function"}),createLine:function(a){var b=d3.svg.line().x(this.x).y(this.y),c=a.interpolate||this.interpolate();return c&&b.interpolate(c),b}})),d3.chart("Line").extend("LineValues",b.XYValues)}(d3,d3.chart.helpers,d3.chart.mixins),function(d3,a){{var b=(a.mixin,a.property);a.di}d3.chart("Component").extend("Title",{initialize:function(){this.layer("Title",this.base.append("g").classed("chart-title",!0),{dataBind:function(){return this.selectAll("text").data([0])},insert:function(){return this.append("text")},events:{merge:function(){var a=this.chart();this.attr("transform",a.transformation()).attr("style",a.style()).attr("text-anchor","middle").attr("class",a.options()["class"]).text(a.text())}}})},text:b("text",{get:function(){return this.options().text}}),rotation:b("rotation",{default_value:function(){var a={right:90,left:-90};return a[this.position()]||0}}),style:b("style",{default_value:{}}),transformation:function(){var b=a.translate(this.width()/2,this.height()/2),c=a.rotate(this.rotation());return b+" "+c}},{z_index:70})}(d3,d3.chart.helpers,d3.chart.mixins),function(d3,a,b){{var c=a.mixin,d=a.property;a.di}d3.chart("Component").extend("Axis",c(b.XY,{initialize:function(){this.axis=d3.svg.axis(),this._layout_axis=d3.svg.axis(),this.axis_base=this.base.append("g").attr("class","chart-axis"),this._layout_base=this.base.append("g").attr("class","chart-axis chart-layout").attr("style","display: none;"),this.layer("Axis",this.axis_base,{dataBind:function(){var a=this.chart();return a._setupAxis(a.axis),this.selectAll("g").data([0])},insert:function(){return this.append("g")},events:{enter:function(){var a=this.chart();this.attr("transform",a.translation()).call(a.axis)},update:function(){this.attr("transform",this.chart().translation())},"update:transition":function(){var a=this.chart();a.delay()&&this.delay(a.delay()),a._skip_transition?(this.duration(0),a._skip_transition=void 0):a.duration()&&this.duration(a.duration()),a.ease()&&this.ease(a.ease()),this.call(a.axis)},exit:function(){this.selectAll("g").remove()}}}),this.layer("_LayoutAxis",this._layout_base,{dataBind:function(){var a=this.chart();return a._setupAxis(a._layout_axis),this.selectAll("g").data([0])},insert:function(){return this.append("g")},events:{merge:function(){var a=this.chart();this.attr("transform",a.translation()).call(a.axis)}}})},duration:d("duration",{type:"Function"}),delay:d("delay",{type:"Function"}),ease:d("ease",{type:"Function"}),scale:d("scale",{type:"Function",set:function(b){var c=a.createScale(b);return"vertical"==this.orientation()?this.yScale(c.copy()):this.xScale(c.copy()),{override:c}}}),position:d("position",{default_value:"bottom",validate:function(a){return _.contains(["top","right","bottom","left","x0","y0"],a)},set:function(){this.scale()&&this.scale(this.scale())}}),translation:d("translation",{default_value:function(){return{top:{x:0,y:0},right:{x:this.width(),y:0},bottom:{x:0,y:this.height()},left:{x:0,y:0},x0:{x:this.x0(),y:0},y0:{x:0,y:this.y0()}}[this.position()]},get:function(b){return a.translate(b)}}),orient:d("orient",{default_value:function(){var a=this.position();return"x0"==a?a="left":"y0"==a&&(a="bottom"),a}}),orientation:d("orientation",{validate:function(a){return _.contains(["horizontal","vertical"],a)},default_value:function(){return{top:"horizontal",right:"vertical",bottom:"horizontal",left:"vertical",x0:"vertical",y0:"horizontal"}[this.position()]},set:function(){this.scale()&&this.scale(this.scale())}}),ticks:d("ticks",{type:"Function"}),tickValues:d("tickValues",{type:"Function"}),tickSize:d("tickSize",{type:"Function"}),innerTickSize:d("innerTickSize",{type:"Function"}),outerTickSize:d("outerTickSize",{type:"Function"}),tickPadding:d("tickPadding",{type:"Function"}),tickFormat:d("tickFormat",{type:"Function"}),getLayout:function(a){var b=this.getState();this.draw(a),this._layout_base.attr("style","display: block;");var c=this._getLabelOverhang();this._layout_base.attr("style","display: none;"),this._previous_raw_data?(this.setState(_.extend(b.previous,{duration:0})),this.draw(this._previous_raw_data),this.setState(b.current)):this._skip_transition=!0,this._previous_raw_data=a;var d=this.position();return"x0"==d?d="bottom":"y0"==d&&(d="right"),{position:d,width:c.width,height:c.height}},setLayout:function(){},getState:function(){return{previous:{scale:this.scale.previous,xScale:this.xScale.previous,yScale:this.yScale.previous,duration:this.duration.previous},current:{scale:this.scale(),xScale:this.xScale(),yScale:this.yScale(),duration:this.duration()}}},setState:function(a){this.xScale(a.xScale).yScale(a.yScale).scale(a.scale).duration(a.duration)},_setupAxis:function(a){this.axis.scale("vertical"==this.orientation()?this.yScale():this.xScale());var b=["orient","ticks","tickValues","tickSize","innerTickSize","outerTickSize","tickPadding","tickFormat"],c=["tickValues"];_.each(b,function(b){var d=this[b]&&this[b]();_.isUndefined(d)||(_.isArray(d)&&!_.contains(c,b)?a[b].apply(a,d):a[b](d))},this)},_getLabelOverhang:function(){var a={width:[0],height:[0]},b=this.orientation();return this._layout_base.selectAll(".tick").each(function(){try{var c=this.getBBox();"horizontal"==b?a.height.push(c.height):a.width.push(c.width)}catch(d){}}),{width:_.max(a.width),height:_.max(a.height)}}}),{layer_type:"chart",z_index:60}),d3.chart("Axis").extend("AxisValues",c(b.XYValues))}(d3,d3.chart.helpers,d3.chart.mixins),function(d3,a){function b(b,c){function d(a,c){return c>0&&b.padding?b.padding:0}if(b&&!c&&(c=b,b={direction:"vertical",origin:"top",padding:0}),c&&c.attr){var e=0;
c.attr("transform",function(c,f){var g=this.getBBox(),h=0,i=0;return"horizontal"==b.direction?("left"!=b.origin&&"right"!=b.origin&&(b.origin="left"),h="left"==b.origin?e+d(c,f):e+g.width+d(c,f),e=e+g.width+d(c,f)):("top"!=b.origin&&"bottom"!=b.origin&&(b.origin="top"),i="top"==b.origin?e+d(c,f):e+g.height+d(c,f),e=e+g.height+d(c,f)),a.translate(h,i)})}}var c=a.utils,d=a.property,e=a.di;d3.chart("Component").extend("Legend",{initialize:function(){this.legend_base=this.base.append("g").classed("chart-legend",!0),this.layer("Legend",this.legend_base,{dataBind:function(a){return this.selectAll("g").data(a,this.chart().itemKey)},insert:function(){var a=this.chart(),b=this.append("g").attr("class",a.itemClass);return b.append("g").attr("width",a.swatchDimensions().width).attr("height",a.swatchDimensions().height).attr("class","chart-legend-swatch"),b.append("text").attr("class","chart-legend-label"),b},events:{merge:function(){var c=this.chart(),d=c.swatchDimensions();this.select("g").each(c.createSwatch),this.select("text").text(c.itemText).each(function(){var b=a.alignText(this,d.height);d3.select(this).attr("transform",a.translate(d.width+5,b))});var e={top:"horizontal",right:"vertical",bottom:"horizontal",left:"vertical"};this.call(b.bind(this,{direction:e[c.position()],origin:"top",padding:5}))}}})},charts:d("charts"),swatchDimensions:d("swatchDimensions",{default_value:{width:20,height:20}}),transform:function(b){if(this.charts()){var d=this.container.charts();b=c.reduce(this.charts(),function(b,e){var f=d[e];if(!f||f.exclude_from_legend||f.options().exclude_from_legend)return b;var g=this.container.demux(e,this.container.data());a.isSeriesData(g)||(g=[g]);var h=c.compact(c.map(g,function(a,b){return a&&!a.exclude_from_legend?{text:a.name||"Series "+(b+1),key:a.key?e+"."+a.key:null,type:f.type,"class":c.compact(["chart-series","chart-index-"+b,f.options()["class"],a["class"]]).join(" ")}:void 0}));return b.concat(h)},[],this)}return b},itemKey:e(function(a,b){return b.key}),itemText:e(function(a,b){return b.text}),itemClass:e(function(){return"chart-legend-group"}),swatchClass:e(function(a,b){return b["class"]}),createSwatch:e(function(a,b,c){var d=d3.select(this);d.selectAll("*").remove(),d.attr("class",a.swatchClass);var e=d3.chart("Legend").swatches;e&&(b&&b.type&&e[b.type]?e[b.type].call(d,a,b,c):e["default"]&&e["default"].call(d,a,b,c))})},{z_index:200,swatches:{"default":function(a){var b=a.swatchDimensions();this.append("circle").attr("cx",b.width/2).attr("cy",b.height/2).attr("r",c.min([b.width,b.height])/2).attr("class","chart-swatch")}},registerSwatch:function(a,b){c.isArray(a)||(a=[a]),c.each(a,function(a){this.swatches[a]=b},this)}}),d3.chart("Legend").registerSwatch(["Line","LineValues"],function(a){var b=a.swatchDimensions();return this.append("line").attr("x1",0).attr("y1",b.height/2).attr("x2",b.width).attr("y2",b.height/2).attr("class","chart-line")}),d3.chart("Legend").registerSwatch(["Bars","StackedBars"],function(a){var b=a.swatchDimensions();return this.append("rect").attr("x",0).attr("y",0).attr("width",b.width).attr("height",b.height).attr("class","chart-bar")}),d3.chart("Legend").extend("InsetLegend",{initialize:function(){this.on("draw",function(){var b=this.translation();this.legend_base.attr("transform",a.translate(b.x,b.y))}.bind(this))},translation:d("translation",{default_value:{x:10,y:0,relative_to:"left-top"},get:function(b){var c=b.x||0,d=b.y||0,e=b.relative_to&&b.relative_to.split("-")[0]||"left",f=b.relative_to&&b.relative_to.split("-")[1]||"top";return"right"===e&&(c=this.width()-a.dimensions(this.legend_base).width-c),"bottom"===f&&(d=this.height()-a.dimensions(this.legend_base).height-d),{x:c,y:d}}}),skip_layout:!0},{layer_type:"chart"})}(d3,d3.chart.helpers),function(d3,a){var b=a.utils;d3.chart.xy=function(a){a=a||{};var c=b.extend({},a.charts),d=b.extend({},a.components),e=8,f={top:e,right:e,bottom:e,left:e};if(a.title){var g=a.title;b.isString(g)&&(g={text:g}),g=b.defaults({},g,{type:"Title",position:"top","class":"chart-title-main",margins:f}),d.title=g}if(b.each(a.axes,function(a,c){var g={x:"bottom",y:"left",x2:"top",y2:"right",secondaryX:"top",secondaryY:"right"};if(a=b.defaults({},a,{type:"Axis",position:g[c]}),d["axis."+c]=a,a.title){var h=a.title;b.isString(h)&&(h={text:h}),h=b.defaults({},h,{type:"Title",position:a.position,"class":"chart-title-axis",margins:b.defaults({top:{top:e/2},right:{left:e/2},bottom:{bottom:e/2},left:{right:e/2}}[a.position],f)}),d["axis."+c+".title"]=h}}),a.legend){var h=a.legend;h===!0&&(h={}),h=b.defaults({},h,{type:"Legend",position:"right",margins:f}),h.data||h.charts||(h.charts=b.keys(c)),d.legend=h}return{charts:c,components:d}}}(d3,d3.chart.helpers);
//# sourceMappingURL=d3.chart.multi-all.min.js.map